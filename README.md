# ğŸ§  RAG Chat Storage Service

A Spring Bootâ€“based backend microservice designed to store and manage chat sessions and messages generated by a **Retrieval-Augmented Generation (RAG)** chatbot system.

This service focuses on **conversation persistence**, **session lifecycle management**, **secure API access**, and **scalability**, making it suitable for integration with any LLM or RAG-based application.

---

## âœ¨ Features

- âœ… Create, update, and delete chat sessions
- âœ… Store user and AI-generated messages for the session
- âœ… Retrieving chat messages - pagination support
- âœ… Persist RAG retrieved context and model metadata
- âœ… Centralized logging and error management
- âœ… API Keyâ€“based authentication
- âœ… Rate limiting to prevent API abuse, 10 api request per minute
- âœ… PostgreSQL persistence
- âœ… Swagger / OpenAPI documentation
- âœ… Clean layered architecture
- âœ… Dockerized for local setup 
- âœ… Dockerized for database management
- âœ… Unit testing
- âœ… Health check endpoint added

---

## ğŸ—ï¸ Tech Stack

- **Java 17**
- **Spring Boot**
- **Spring Data JPA (Hibernate)**
- **Spring Security**
- **PostgreSQL**
- **Swagger / OpenAPI**
- **Maven**
- **Docker**

---

## ğŸ“‚ Project Structure

rag-chat-storage
â”œâ”€â”€ controller # REST controllers
â”œâ”€â”€ service # Business logic
â”œâ”€â”€ repository # JPA repositories
â”œâ”€â”€ entity # JPA entities
â”œâ”€â”€ dto # Request / Response DTOs
â”œâ”€â”€ mapper # Entity â†” DTO mapping
â”œâ”€â”€ security # API key & rate limiting filters
â”œâ”€â”€ exception # Custom exceptions
â””â”€â”€ utils # Logging & helpers


## Example API Call (Postman)

Add Message
## Required Request Header

**URL**

POST /sessions/{sessionId}/messages


**Headers**

X-API-KEY: super-key
Content-Type: application/json


**Request Body**

{
  "sender": "ASSISTANT",
  "content": "We offer refunds within 30 days of purchase.",
  "ragContext": [
    {
      "sourceId": "doc_201",
      "sourceType": "PDF",
      "title": "Refund Policy",
      "excerpt": "Refunds are available within 30 days if unused.",
      "similarityScore": 0.93
    }
  ],
  "modelMetadata": {
    "model": "gpt-4.1",
    "temperature": 0.2
  }
}

## ğŸ³ Running the Application with Docker & pgAdmin ##

This project uses Docker Compose to run:

PostgreSQL database

pgAdmin (UI to browse PostgreSQL)

(Optionally) the Spring Boot application

ğŸ“¦ **Prerequisites**

Make sure you have the following installed:

Docker
ğŸ‘‰ https://www.docker.com/products/docker-desktop

Docker Compose (comes with Docker Desktop)

Verify installation:

docker --version
docker compose version

ğŸ“ Docker Files Overview
rag-chat-storage
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ Dockerfile          # (optional â€“ for Spring Boot app)
â””â”€â”€ README.md




â–¶ï¸ **Start Docker Containers**

docker compose up -d

## ğŸ—„ï¸ Access pgAdmin (Database UI) ##
**Open in browser:**
[Open in browser:](http://localhost:5050)
**Login credentials:**
Email: admin@ragchat.com
Password: admin

**ğŸ”Œ Connect pgAdmin to PostgreSQL**

Right-click Servers â†’ Register â†’ Server

General Tab

Name: rag-chat-postgres

Connection Tab

Host name/address: postgres

Port: 5432

Maintenance database: rag-chat

Username: postgres

Password: admin123

Click Save

ğŸ‰ You can now browse:



